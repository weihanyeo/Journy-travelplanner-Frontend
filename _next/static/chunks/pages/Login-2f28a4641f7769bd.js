(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[667],{2620:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Login",function(){return r(225)}])},225:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var s=r(5893),n=r(7294),o=r(1163),a=r(3097);class l extends Error{}l.prototype.name="InvalidTokenError";var i=()=>{let e=(0,o.useRouter)(),[t,r]=(0,n.useState)({username:"",password:""}),[i,c]=(0,n.useState)(""),[d,u]=(0,n.useState)(null),m=e=>s=>{r({...t,[e]:s.target.value})},p=()=>{let e=!1,{username:r,password:s}=t,n="";return r.length<1&&(e=!0,n+="Username is missing. "),s.length<1&&(e=!0,n+="Password is missing. "),c(n),e},h=async()=>{if(!p())try{console.log("Attempting to log in...");let r=await a.Z.post("/members/authenticate",t);console.log("Login successful!");let{token:s,user:n}=r.data;console.log("Received token and user data from server");let o=function(e,t){let r;if("string"!=typeof e)throw new l("Invalid token specified: must be a string");t||(t={});let s=!0===t.header?0:1,n=e.split(".")[s];if("string"!=typeof n)throw new l(`Invalid token specified: missing part #${s+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(n)}catch(e){throw new l(`Invalid token specified: invalid base64 for part #${s+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new l(`Invalid token specified: invalid json for part #${s+1} (${e.message})`)}}(s);console.log("decoded:",o),localStorage.setItem("currentUser",o.sub),localStorage.setItem("jwt",s),console.log("Stored JWT token in local storage"),u(n),console.log("Stored user data in application state/context"),setTimeout(()=>{window.location.reload()},500),e.replace("/Discover")}catch(e){console.error("Error occurred during login:",e),e.response?(c(e.response.data.message),console.error("Error message set:",e.response.data.message)):(c("An error occurred. Please try again later."),console.error("Generic error message set"))}};return(0,s.jsxs)("div",{className:"container mt-3 justify-content-center",style:{minHeight:"40rem",maxWidth:"40rem"},children:[(0,s.jsx)("h1",{className:"text-center",children:" Welcome back to Journy"}),(0,s.jsx)("h5",{className:"text-center",style:{fontWeight:"50"},children:"Where enchanted journeys begin. Log in or sign up to continue"}),i.length>0&&(0,s.jsx)("div",{className:"alert alert-warning alert-dismissible fade show",role:"alert",children:(0,s.jsxs)("div",{children:["Holy guacamole!",(0,s.jsxs)("strong",{children:[" ",i.substring(0,i.length-2)]})]})}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{for:"exampleFormControlInput1",className:"form-label",children:"Username"}),(0,s.jsx)("input",{type:"username",className:"form-control",id:"exampleFormControlInput1",placeholder:"Username",value:t.username,onChange:m("username")})]}),(0,s.jsx)("label",{for:"inputPassword5",className:"form-label",children:"Password"}),(0,s.jsx)("input",{type:"password",id:"inputPassword5",className:"form-control","aria-describedby":"passwordHelpBlock",value:t.password,onChange:m("password")}),(0,s.jsxs)("div",{id:"passwordHelpBlock m",className:"form-text",children:["Your password ",(0,s.jsx)("b",{children:"must be"})," 8-20 characters long, contain letters and numbers, and ",(0,s.jsx)("b",{children:"must not contain"})," spaces, special characters, or emoji."]}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{type:"button",className:"btn btn-primary rounded-4",style:{width:"100%",fontSize:"0.9rem"},onClick:h,children:"Log in"}),(0,s.jsx)("h6",{className:"text-center mt-4",style:{fontWeight:"40"},children:"Don't have an account?"}),(0,s.jsx)("button",{type:"button",className:"btn btn-primary rounded-4",style:{width:"100%",fontSize:"0.9rem",marginBottom:"10px"},onClick:()=>e.push("/Signup"),children:"Sign up"})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=2620)}),_N_E=e.O()}]);